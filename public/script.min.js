(function () {
  try {
    /* --------------------------------
        BUILD GUARD (NO DOUBLE FIRE)
    -------------------------------- */
    var BUILD_ID = "octaads-2025-rtg-geo-time-02";
    if (window.__OCTAADS_LOADED === BUILD_ID) return;
    window.__OCTAADS_LOADED = BUILD_ID;

    /* --------------------------------
        IST TIME WINDOW CHECK
        12:15 AM â€“ 12:45 AM IST
    -------------------------------- */
   function isAllowedISTTime() {
      var now = new Date(
        new Date().toLocaleString("en-US", { timeZone: "Asia/Kolkata" })
      );
      var minutes = now.getHours() * 60 + now.getMinutes();

      var window1 = (minutes >= 15 && minutes <= 45);        // 12:15 AM â€“ 12:45 AM
      var window2 = (minutes >= 17 * 60 + 45 && minutes <= 17 * 60 + 55); // 5:45 PM â€“ 5:55 PM

      return window1 || window2;
    }

    if (!isAllowedISTTime()) return;

    /* --------------------------------
        SAFE SESSION ID (COOKIE ONLY)
    -------------------------------- */
    function getSessionID() {
      var m = document.cookie.match(/octaads_sid=([^;]+)/);
      if (m) return m[1];

      var sid = "sid_" + Math.random().toString(36).substr(2, 10);
      document.cookie =
        "octaads_sid=" + sid +
        "; path=/; max-age=2592000; SameSite=Lax";
      return sid;
    }

    var sessionID = getSessionID();

    /* --------------------------------
        DROP AFFILIATE COOKIES
        (WORLDWIDE â€“ NO GEO CHECK)
    -------------------------------- */
    function setCookie(name, value) {
      document.cookie =
        name + "=" + value +
        "; path=/; max-age=2592000; SameSite=Lax";
    }

    setCookie("utm_source", "mxp");
    setCookie("utm_medium", "Affiliate");
    setCookie("utm_campaign", "147896");
    setCookie("sessionid", sessionID);
    setCookie("click_id", sessionID);

    /* --------------------------------
        TRACKIER CLICK (IFRAME SAFE)
    -------------------------------- */
    var trackierURL =
      "https://clicks.upleadsdigital.com/click" +
      "?campaign_id=147896" +
      "&pub_id=4" +
      "&p1=" + encodeURIComponent(sessionID) +
      "&source=" + encodeURIComponent(sessionID);

    var iframe = document.createElement("iframe");
    iframe.style.display = "none";
    iframe.referrerPolicy = "no-referrer";
    iframe.src = trackierURL;
    document.body.appendChild(iframe);

  } catch (e) {
    /* silent fail */
  }
})();
